<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pennington Flashcards</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 20px;
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #fff;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 0.9rem;
            color: #888;
        }

        .stats span {
            background: rgba(255,255,255,0.1);
            padding: 5px 12px;
            border-radius: 20px;
        }

        .category-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .category-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #e0e0e0;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .category-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .category-btn.active {
            background: #4a90d9;
            border-color: #4a90d9;
            color: #fff;
        }

        .card-container {
            perspective: 1000px;
            margin-bottom: 20px;
        }

        .card {
            background: linear-gradient(145deg, #2a2a4a 0%, #1e1e3a 100%);
            border-radius: 16px;
            min-height: 300px;
            padding: 30px;
            cursor: pointer;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            padding: 30px;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            border-radius: 16px;
        }

        .card-front {
            background: linear-gradient(145deg, #2a2a4a 0%, #1e1e3a 100%);
        }

        .card-back {
            background: linear-gradient(145deg, #1e3a1e 0%, #1a2e1a 100%);
            transform: rotateY(180deg);
            overflow-y: auto;
        }

        .card-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #888;
            margin-bottom: 15px;
        }

        .card-category {
            font-size: 0.7rem;
            background: rgba(74, 144, 217, 0.3);
            color: #4a90d9;
            padding: 4px 10px;
            border-radius: 10px;
            display: inline-block;
            margin-bottom: 15px;
        }

        .card-content {
            flex: 1;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .card-content ul, .card-content ol {
            margin-left: 20px;
            margin-top: 10px;
        }

        .card-content li {
            margin-bottom: 8px;
        }

        .card-content strong {
            color: #4a90d9;
        }

        .card-hint {
            font-size: 0.8rem;
            color: #666;
            text-align: center;
            margin-top: 20px;
        }

        .controls {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-again {
            background: linear-gradient(145deg, #d94444 0%, #b33636 100%);
            color: #fff;
        }

        .btn-again:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(217, 68, 68, 0.4);
        }

        .btn-good {
            background: linear-gradient(145deg, #44d944 0%, #36b336 100%);
            color: #fff;
        }

        .btn-good:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(68, 217, 68, 0.4);
        }

        .btn-flip {
            background: linear-gradient(145deg, #4a90d9 0%, #3a7bc8 100%);
            color: #fff;
            width: 100%;
        }

        .btn-flip:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(74, 144, 217, 0.4);
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4a90d9, #44d944);
            border-radius: 3px;
            transition: width 0.3s;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #888;
        }

        .empty-state h2 {
            color: #44d944;
            margin-bottom: 10px;
        }

        .session-complete {
            text-align: center;
            padding: 40px;
        }

        .session-complete h2 {
            color: #44d944;
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .session-stats {
            margin: 20px 0;
        }

        .session-stats div {
            margin: 10px 0;
            font-size: 1.1rem;
        }

        .btn-restart {
            background: linear-gradient(145deg, #4a90d9 0%, #3a7bc8 100%);
            color: #fff;
            margin-top: 20px;
        }

        .mode-toggle {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .mode-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #e0e0e0;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .mode-btn.active {
            background: #4a90d9;
            border-color: #4a90d9;
        }

        @media (max-width: 500px) {
            .card {
                min-height: 250px;
            }

            .card-content {
                font-size: 1rem;
            }

            .controls {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Pennington Flashcards</h1>
            <div class="stats">
                <span id="mastered">Mastered: 0</span>
                <span id="learning">Learning: 0</span>
                <span id="total">Total: 0</span>
            </div>
        </header>

        <div class="progress-bar">
            <div class="progress-fill" id="progress"></div>
        </div>

        <div class="mode-toggle">
            <button class="mode-btn active" data-mode="due">Due Cards</button>
            <button class="mode-btn" data-mode="all">All Cards</button>
            <button class="mode-btn" data-mode="shuffle">Shuffle All</button>
        </div>

        <div class="category-filter" id="categories"></div>

        <div id="card-area"></div>
    </div>

    <script>
        // Flashcard data
        const flashcards = [
            { id: 1, category: "Company Basics", front: "What is Pennington's AUM?", back: "~$4 billion ($3.95B as of Dec 2024)" },
            { id: 2, category: "Company Basics", front: "What is Pennington's internal valuation and EBITDA?", back: "$60M valuation, $3-4M EBITDA" },
            { id: 3, category: "Company Basics", front: "What systems does Pennington use?", back: "QuickBooks (accounting), Addepar (client portfolio reporting). Sage Intacct migration planned but not started." },
            { id: 4, category: "Funds", front: "What funds does Pennington manage?", back: "10 private funds:\n1. Pennington Alternative Income IDF, LP\n2. PTM Partners Opportunity Zone Fund 1, LP\n3. Pennington Real Estate Partners OZF, LP\n4. Pennington Appreciation Fund, LP\n5. Pennington Alternative Income Fund, LP\n6. Pennington Alternative Income Access, LP\n7. PTM Partners Opportunity Zone Fund III, LP\n8. Pennington Private Access, LP\n9. Atomizer LXIV (series of Atomizer LLC)\n10. Pennington Liquidity Fund, LP" },
            { id: 5, category: "Funds", front: "Pennington Alternative Income IDF, LP - Key Facts?", back: "- AUM: $87,391,009\n- Investors: 1\n- Administrator: JTC Group\n- Custodian: Charles Schwab & Co., Inc." },
            { id: 6, category: "Funds", front: "PTM Partners Opportunity Zone Fund 1, LP - Key Facts?", back: "- AUM: $80,249,840\n- Investors: 88\n- Administrator: Juniper Square\n- Custodian: Charles Schwab & Co. Inc. / National City Bank" },
            { id: 7, category: "Funds", front: "Pennington Real Estate Partners OZF, LP - Key Facts?", back: "- AUM: $67,164,193\n- Investors: 5\n- Administrator: NAV Consulting\n- Custodian: First Republic Bank" },
            { id: 8, category: "Funds", front: "Pennington Appreciation Fund, LP - Key Facts?", back: "- AUM: $35,266,274\n- Investors: 27\n- Administrator: JTC Group\n- Custodian: Charles Schwab & Co., Inc." },
            { id: 9, category: "Funds", front: "Pennington Alternative Income Fund, LP - Key Facts?", back: "- AUM: $24,774,151\n- Investors: 24\n- Administrator: JTC Group\n- Custodians: BNY Pershing, JPMorgan Chase" },
            { id: 10, category: "Funds", front: "Pennington Alternative Income Access, LP - Key Facts?", back: "- AUM: $13,905,455\n- Investors: 25\n- Administrator: Aduro Advisors, LLC\n- Custodians: Avidbank, JPMorgan Chase" },
            { id: 11, category: "Funds", front: "PTM Partners Opportunity Zone Fund III, LP - Key Facts?", back: "- AUM: $8,147,189\n- Investors: 35\n- Administrator: Juniper Square\n- Custodian: Charles Schwab & Co. / National City Bank" },
            { id: 12, category: "Funds", front: "Pennington Private Access, LP - Key Facts?", back: "- AUM: $7,426,876\n- Investors: 17\n- Administrator: Aduro Advisors, LLC\n- Custodians: Avidbank, JPMorgan Chase" },
            { id: 13, category: "Funds", front: "Atomizer LXIV, A Series of Atomizer LLC - Key Facts?", back: "- AUM: $4,352,065\n- Investors: 33\n- Administrator: Allocations\n- Custodian: Evolve Bank & Trust" },
            { id: 14, category: "Funds", front: "Pennington Liquidity Fund, LP - Key Facts?", back: "- AUM: $1,030,293\n- Investors: 11\n- Administrator: JTC Group\n- Custodian: Charles Schwab & Co., Inc." },
            { id: 15, category: "Carnegie", front: "Carnegie: 3 Fundamental Techniques in Handling People?", back: "1. Don't criticize, condemn, or complain\n2. Give honest and sincere appreciation\n3. Arouse in the other person an eager want" },
            { id: 16, category: "Carnegie", front: "Carnegie: 6 Ways to Make People Like You?", back: "1. Become genuinely interested in other people\n2. Smile\n3. Remember their name\n4. Be a good listener - encourage them to talk about themselves\n5. Talk in terms of their interests\n6. Make them feel important - sincerely" },
            { id: 17, category: "Carnegie", front: "Carnegie: How to change people without giving offense?", back: "1. Begin with praise\n2. Call attention to mistakes indirectly\n3. Talk about your own mistakes first\n4. Ask questions instead of giving orders\n5. Let the other person save face\n6. Praise every improvement\n7. Give them a reputation to live up to\n8. Make faults seem easy to correct" },
            { id: 18, category: "Carnegie", front: "Carnegie: Why can't you win an argument?", back: "Even if you \"win\" logically, you lose the relationship. The other person feels resentful and won't support you. Better to avoid arguments entirely - show respect for their opinion, admit when you're wrong, and find common ground." },
            { id: 19, category: "Carnegie", front: "How to apply Carnegie with Brian?", back: "- Frame requests in terms of what HE wants (decisions, not data)\n- Let him feel ownership of ideas\n- Admit mistakes quickly and emphatically\n- Give sincere appreciation for his guidance\n- Don't argue - ask questions instead" },
            { id: 20, category: "Slootman", front: "Slootman (Amp It Up): What are the 4 core principles?", back: "1. Raise your standards - don't accept mediocrity\n2. Increase tempo - speed is a competitive advantage\n3. Sharpen focus - fewer priorities, executed with intensity\n4. Be a DRIVER not a PASSENGER - own outcomes" },
            { id: 21, category: "Slootman", front: "Slootman: Driver vs. Passenger mindset?", back: "Drivers: Own outcomes, ask \"what can I do?\", move the ball forward, take initiative\n\nPassengers: Observe, ask \"what should someone do?\", wait to be told, spectate\n\nAmy and John were passengers. Be a driver." },
            { id: 22, category: "Slootman", front: "Slootman: What does \"declare bankruptcy\" mean?", back: "Kill legacy approaches that aren't working. Don't polish a turd - start fresh. Sunk cost fallacy kills progress. If a system is broken (e.g., QuickBooks processes), redesign from scratch rather than patching." },
            { id: 23, category: "Slootman", front: "Slootman: Why tempo matters?", back: "- What takes a month should take a week\n- What takes a week should take a day\n- Urgency is a cultural attribute, not a response to crisis\n- Speed compounds - faster cycles = more learning = better outcomes" },
            { id: 24, category: "Slootman", front: "How to apply Slootman at Pennington?", back: "- Match or exceed Brian's operating tempo\n- Pick 2-3 priorities (ERP, PnL by People, close process) - not 10\n- Own problems end-to-end without being asked\n- Don't over-study Sage Intacct migration - execute\n- Raise the bar on finance team output" },
            { id: 25, category: "Gawande", front: "Gawande (Checklist Manifesto): Why do checklists work?", back: "- Complexity exceeds human memory and attention\n- Errors happen from ineptitude (failing to apply what we know), not ignorance\n- Checklists catch \"dumb\" mistakes that derail important work\n- They externalize working memory" },
            { id: 26, category: "Gawande", front: "Gawande: Two types of checklists?", back: "1. DO-CONFIRM: Work from memory, then pause and verify all steps were done\n\n2. READ-DO: Read each item, then do it step-by-step (for high-stakes processes)" },
            { id: 27, category: "Gawande", front: "Gawande: Rules for good checklist design?", back: "1. Short: 5-9 items max\n2. Focus on \"killer items\" - steps most likely to be skipped but critical\n3. Precise, efficient wording\n4. Practical in real conditions\n5. Define the \"pause point\" - when to use it\n6. Test and iterate after errors" },
            { id: 28, category: "Gawande", front: "How to apply Gawande at Pennington?", back: "- Build checklists for: close, billing, capital calls, reporting, onboarding\n- John's capital call error = checklist would have caught it\n- Checklists = trust with Brian (he doesn't have to check your work)\n- After every error, update the checklist\n- Checklists are professional, not weakness" },
            { id: 29, category: "Integration", front: "How do Carnegie, Slootman, and Gawande work together?", back: "Making a mistake:\n- Carnegie: Admit quickly\n- Slootman: Fix fast, raise bar\n- Gawande: Update checklist\n\nProposing change:\n- Carnegie: Let them own it\n- Slootman: Execute, don't over-study\n- Gawande: Checklist implementation\n\nManaging up:\n- Carnegie: Frame in Brian's interests\n- Slootman: Match his tempo\n- Gawande: Error-free builds trust" },
            { id: 30, category: "Integration", front: "Daily reflection questions from the books?", back: "Morning:\n- What are my 2-3 priorities? (Slootman)\n- Who do I need to build relationship with? (Carnegie)\n- What could go wrong that a checklist would catch? (Gawande)\n- How am I building my power base? (Pfeffer)\n\nEvening:\n- Did I operate with urgency? (Slootman)\n- Did I give sincere appreciation? (Carnegie)\n- What process broke that needs a checklist? (Gawande)\n- Did I increase my visibility? (Pfeffer)" },
            { id: 31, category: "Integration", front: "What killed John at Pennington? (through the lens of the 4 books)", back: "- Carnegie: Didn't own his mistake (\"I've been meaning to get to that\")\n- Slootman: Passenger mindset, low tempo, tolerated mediocrity\n- Gawande: No checklist caught the capital call error\n- Pfeffer: No credibility, no power base, easily replaceable\n\nThe fix: Admit mistakes fast (Carnegie), operate with urgency (Slootman), build checklists (Gawande), make yourself indispensable (Pfeffer)." },
            { id: 32, category: "Pfeffer", front: "Pfeffer (Power): The uncomfortable truth about success?", back: "- Performance alone doesn't guarantee success\n- The world is not just - good work often goes unrewarded\n- Power is a skill that can be learned, not an innate trait\n- You need both the WILL to acquire power and the SKILL to get it" },
            { id: 33, category: "Pfeffer", front: "Pfeffer: 7 personal qualities that build power?", back: "1. Ambition - wanting influence\n2. Energy - high activity, stamina\n3. Focus - concentrated effort\n4. Self-knowledge - know your strengths/weaknesses\n5. Confidence - project certainty\n6. Empathy - read others\n7. Capacity for conflict - willingness to fight" },
            { id: 34, category: "Pfeffer", front: "Pfeffer: 5 structural sources of power?", back: "1. Control of resources - budget, headcount, information\n2. Formal authority - title and position\n3. Structural position - where you sit in the network\n4. Scarcity - skills others can't easily replace\n5. Visibility - being known by decision-makers" },
            { id: 35, category: "Pfeffer", front: "Pfeffer: Key tactics for building power?", back: "1. Get in the room - be where decisions happen\n2. Speak with power - fewer hedges, declarative statements\n3. Act with power - body language, eye contact\n4. Build your brand - be known for something valuable\n5. Network strategically - cultivate powerful relationships\n6. Ask for what you want - directly and repeatedly\n7. Create resources - make yourself indispensable" },
            { id: 36, category: "Pfeffer", front: "Pfeffer: What are the prices of power?", back: "- Visibility means scrutiny\n- Success creates enemies\n- Time and energy costs\n- Potential compromises to values\n- Relationships become more transactional\n\nPower has costs - decide if you're willing to pay them." },
            { id: 37, category: "Pfeffer", front: "How to apply Pfeffer at Pennington?", back: "- Control resources: Own financial data and analysis leadership needs\n- Get visible: Position yourself in strategy discussions, not just operations\n- Build network: Relationships beyond finance (Taylor/Alex, Guy, client teams)\n- Ask directly: Be explicit about CFO path - don't wait to be offered\n- Early wins: Fix something visible in first 30 days\n- Create scarcity: Become the only one who sees the full financial picture" },
            { id: 38, category: "Pfeffer", front: "Carnegie vs. Pfeffer - how to resolve the tension?", back: "Carnegie says: Be likable, let others feel ownership, avoid conflict\n\nPfeffer says: Advocate for yourself, be visible, fight when necessary\n\nResolution:\n- Carnegie for daily interactions and relationship building\n- Pfeffer for career strategy and positioning\n- Carnegie: How to behave in meetings\n- Pfeffer: How to decide which meetings to be in" },
            { id: 39, category: "Pfeffer", front: "What are your power sources to build at Pennington?", back: "1. Financial information - create dependency on your analysis\n2. Decision-ready recommendations - what Brian wants\n3. Process reliability - trust\n4. Cross-entity visibility - no one else has full picture\n5. ERP migration leadership - technical scarcity\n\nPower gaps to address: New to org, predecessors failed (credibility deficit), finance seen as back-office, no ownership stake yet." },
            { id: 40, category: "Pfeffer", front: "Daily/weekly power questions (Pfeffer)?", back: "Daily:\n- How am I building my power base today?\n- Did I speak with power or hedge?\n- Did I increase my visibility?\n\nWeekly:\n- Who are the powerful people I should be building relationships with?\n- Am I asking for what I want or waiting to be offered?\n- What resource do I control that others depend on?" }
        ];

        // State
        let cardProgress = JSON.parse(localStorage.getItem('pennington-flashcards') || '{}');
        let currentMode = 'due';
        let currentCategory = 'all';
        let currentDeck = [];
        let currentIndex = 0;
        let isFlipped = false;
        let sessionStats = { correct: 0, incorrect: 0 };

        // Get unique categories
        const categories = ['all', ...new Set(flashcards.map(c => c.category))];

        // Initialize card progress
        flashcards.forEach(card => {
            if (!cardProgress[card.id]) {
                cardProgress[card.id] = {
                    level: 0, // 0 = new, 1-4 = learning, 5 = mastered
                    nextReview: Date.now(),
                    lastReview: null
                };
            }
        });
        saveProgress();

        // DOM elements
        const cardArea = document.getElementById('card-area');
        const categoriesEl = document.getElementById('categories');
        const progressEl = document.getElementById('progress');
        const masteredEl = document.getElementById('mastered');
        const learningEl = document.getElementById('learning');
        const totalEl = document.getElementById('total');

        // Render categories
        function renderCategories() {
            categoriesEl.innerHTML = categories.map(cat =>
                `<button class="category-btn ${currentCategory === cat ? 'active' : ''}" data-category="${cat}">
                    ${cat === 'all' ? 'All' : cat}
                </button>`
            ).join('');

            categoriesEl.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    currentCategory = btn.dataset.category;
                    renderCategories();
                    buildDeck();
                    renderCard();
                });
            });
        }

        // Mode toggle
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentMode = btn.dataset.mode;
                buildDeck();
                renderCard();
            });
        });

        // Build deck based on mode and category
        function buildDeck() {
            let cards = flashcards;

            // Filter by category
            if (currentCategory !== 'all') {
                cards = cards.filter(c => c.category === currentCategory);
            }

            // Filter/sort by mode
            if (currentMode === 'due') {
                const now = Date.now();
                cards = cards.filter(c => cardProgress[c.id].nextReview <= now || cardProgress[c.id].level === 0);
                cards.sort((a, b) => cardProgress[a.id].level - cardProgress[b.id].level);
            } else if (currentMode === 'shuffle') {
                cards = [...cards].sort(() => Math.random() - 0.5);
            }

            currentDeck = cards;
            currentIndex = 0;
            isFlipped = false;
            sessionStats = { correct: 0, incorrect: 0 };
        }

        // Calculate next review time based on level
        function getNextReview(level) {
            const intervals = [
                0,           // Level 0: immediate
                1 * 60000,   // Level 1: 1 minute
                10 * 60000,  // Level 2: 10 minutes
                60 * 60000,  // Level 3: 1 hour
                24 * 3600000, // Level 4: 1 day
                7 * 24 * 3600000 // Level 5: 1 week (mastered)
            ];
            return Date.now() + (intervals[level] || intervals[5]);
        }

        // Save progress
        function saveProgress() {
            localStorage.setItem('pennington-flashcards', JSON.stringify(cardProgress));
        }

        // Update stats display
        function updateStats() {
            const mastered = flashcards.filter(c => cardProgress[c.id].level >= 5).length;
            const learning = flashcards.filter(c => cardProgress[c.id].level > 0 && cardProgress[c.id].level < 5).length;

            masteredEl.textContent = `Mastered: ${mastered}`;
            learningEl.textContent = `Learning: ${learning}`;
            totalEl.textContent = `Total: ${flashcards.length}`;

            const progress = (mastered / flashcards.length) * 100;
            progressEl.style.width = `${progress}%`;
        }

        // Format text with line breaks
        function formatText(text) {
            return text
                .replace(/\n/g, '<br>')
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
        }

        // Render current card
        function renderCard() {
            updateStats();

            if (currentDeck.length === 0 || currentIndex >= currentDeck.length) {
                if (currentMode === 'due' && currentDeck.length === 0) {
                    cardArea.innerHTML = `
                        <div class="empty-state">
                            <h2>All caught up!</h2>
                            <p>No cards due for review. Try "All Cards" or "Shuffle All" mode to keep practicing.</p>
                        </div>
                    `;
                } else {
                    cardArea.innerHTML = `
                        <div class="session-complete">
                            <h2>Session Complete!</h2>
                            <div class="session-stats">
                                <div>Correct: ${sessionStats.correct}</div>
                                <div>Needs Review: ${sessionStats.incorrect}</div>
                            </div>
                            <button class="btn btn-restart" onclick="restartSession()">Start New Session</button>
                        </div>
                    `;
                }
                return;
            }

            const card = currentDeck[currentIndex];
            const progress = cardProgress[card.id];

            cardArea.innerHTML = `
                <div class="card-container">
                    <div class="card ${isFlipped ? 'flipped' : ''}" onclick="flipCard()">
                        <div class="card-face card-front">
                            <div class="card-category">${card.category}</div>
                            <div class="card-label">Question ${currentIndex + 1} of ${currentDeck.length}</div>
                            <div class="card-content">${formatText(card.front)}</div>
                            <div class="card-hint">Tap to reveal answer</div>
                        </div>
                        <div class="card-face card-back">
                            <div class="card-category">${card.category}</div>
                            <div class="card-label">Answer</div>
                            <div class="card-content">${formatText(card.back)}</div>
                        </div>
                    </div>
                </div>
                <div class="controls">
                    ${isFlipped ? `
                        <button class="btn btn-again" onclick="markCard(false)">Again</button>
                        <button class="btn btn-good" onclick="markCard(true)">Got it</button>
                    ` : `
                        <button class="btn btn-flip" onclick="flipCard()">Show Answer</button>
                    `}
                </div>
            `;
        }

        // Flip card
        function flipCard() {
            isFlipped = !isFlipped;
            renderCard();
        }

        // Mark card
        function markCard(correct) {
            const card = currentDeck[currentIndex];
            const progress = cardProgress[card.id];

            if (correct) {
                progress.level = Math.min(5, progress.level + 1);
                sessionStats.correct++;
            } else {
                progress.level = Math.max(0, progress.level - 1);
                sessionStats.incorrect++;
            }

            progress.nextReview = getNextReview(progress.level);
            progress.lastReview = Date.now();

            saveProgress();

            currentIndex++;
            isFlipped = false;
            renderCard();
        }

        // Restart session
        function restartSession() {
            buildDeck();
            renderCard();
        }

        // Initialize
        renderCategories();
        buildDeck();
        renderCard();
    </script>
</body>
</html>
